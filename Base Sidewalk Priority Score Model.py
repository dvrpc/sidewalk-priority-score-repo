# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2025-10-07 15:48:35
"""
import arcpy

def BaseSidewalkConstructionIndex():  # Base Sidewalk Construction Index Model

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    arcpy.ImportToolbox(r"c:\program files\arcgis\pro\Resources\ArcToolbox\toolboxes\Data Management Tools.tbx")
    gis_transportation_pedestriannetwork_gaps = "V:\\Transportation\\transportation@gis.sde\\gis.transportation.pedestriannetwork_gaps"
    pedestriannetwork_gaps_v2 = "U:\\FY2025\\SidewalkGap\\project_output\\output.gdb\\pedestriannetwork_gaps_v2"
    nj_bp_hin_gis_Polylines = "U:\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines"
    pa_bp_hin_gis_Polylines = "U:\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines"
    pa_lr_bp_hin_gis_Polylines = "U:\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines"
    SidewalkConstructionIndex_gdb = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb"
    gis_transportation_njdot_functionalclass_2_ = "V:\\Transportation\\transportation@gis.sde\\gis.transportation.njdot_functionalclass"
    gis_transportation_padot_rmsadmin = "V:\\Transportation\\transportation@gis.sde\\gis.transportation.padot_rmsadmin"
    gis_boundaries_dvrpc_mcd_phicpa = "V:\\Boundaries\\boundaries@gis.sde\\gis.boundaries.dvrpc_mcd_phicpa"
    chstp_priority_score = "U:\\_OngoingProjects\\ETA\\FY2024\\project_output\\output.gdb\\chstp_priority_score"
    gis_planning_diz_blockgroup = "V:\\Planning\\planning@gis.sde\\gis.planning.diz_blockgroup"
    gis_structure_schools_private_k12 = "V:\\Structures\\structure@gis.sde\\gis.structure.schools_private_k12"
    gis_structure_schools_public_k12 = "V:\\Structures\\structure@gis.sde\\gis.structure.schools_public_k12"
    gis_transportation_septa_transitstops = "V:\\Transportation\\transportation@gis.sde\\gis.transportation.septa_transitstops"
    gis_transportation_njtransit_transitstops = "V:\\Transportation\\transportation@gis.sde\\gis.transportation.njtransit_transitstops"
    gis_transportation_PassengerRailStations = "V:\\Transportation\\transportation@gis.sde\\gis.transportation.PassengerRailStations"
    gis_planning_dvrpc_protectedopenspace = "V:\\Planning\\planning@gis.sde\\gis.planning.dvrpc_protectedopenspace"
    TrailIntersections = "U:\\FY2019\\Transportation\\TransitBikePed\\BikeStressPhase2\\maps\\LTS_TileGeneration\\LTS_TileGeneration.gdb\\TrailIntersections"
    gis_transportation_pedestriannetwork_lines = "V:\\Transportation\\transportation@gis.sde\\gis.transportation.pedestriannetwork_lines"
    AOPPorHDC_shp = "U:\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp"
    gis_boundaries_MunicipalBoundaries = "V:\\Boundaries\\boundaries@gis.sde\\gis.boundaries.MunicipalBoundaries"
    sidewalkgaps_symbology = "sidewalkgaps_symbology"

    # Process: Copy Features (Copy Features) (management)
    projected_gaps = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps"
    with arcpy.EnvManager(outputCoordinateSystem="PROJCS[\"NAD_1983_UTM_Zone_18N\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"False_Easting\",500000.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-75.0],PARAMETER[\"Scale_Factor\",0.9996],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]]"):
        arcpy.management.CopyFeatures(in_features=pedestriannetwork_gaps_v2, out_feature_class=projected_gaps)

    # Process: Calculate Field (5) (Calculate Field) (management)
    projected_gaps_2_ = arcpy.management.CalculateField(in_table=projected_gaps, field="sw_id", expression="!OBJECTID!")[0]

    # Process: Merge (Merge) (management)
    merged_hin = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\merged_hin"
    arcpy.management.Merge(inputs=[nj_bp_hin_gis_Polylines, pa_bp_hin_gis_Polylines, pa_lr_bp_hin_gis_Polylines], output=merged_hin, field_mappings="hin_id \"hin_id\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,hin_id,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,hin_id,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,hin_id,-1,-1;sri \"sri\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,sri,0,1999999999;window_from \"window_from\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,window_from,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,window_from,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,window_from,-1,-1;window_to \"window_to\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,window_to,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,window_to,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,window_to,-1,-1;crashcount \"crashcount\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,crashcount,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,crashcount,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,crashcount,-1,-1;total_killed \"total_killed\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,total_killed,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,total_killed,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,total_killed,-1,-1;total_maj_inj \"total_maj_inj\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,total_maj_inj,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,total_maj_inj,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,total_maj_inj,-1,-1;class \"class\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,class,0,1999999999;route_subtype \"route_subtype\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,route_subtype,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\nj_bp_hin_gis_Polylines,Shape_Length,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,Shape_Length,-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,Shape_Length,-1,-1;id \"id\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,id,0,1999999999;interstate \"interstate\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,interstate,0,1999999999;access_ctr \"access_ctr\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_bp_hin_gis_Polylines,access_ctr,0,1999999999;lr_id \"lr_id\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,lr_id,-1,-1;cty_code \"cty_code\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2024\\Transportation\\HIN\\project_output\\hin_v3.gdb\\pa_lr_bp_hin_gis_Polylines,cty_code,0,1999999999")

    # Process: Generate Points Along Lines (2) (Generate Points Along Lines) (management)
    hin_points = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\hin_points"
    arcpy.management.GeneratePointsAlongLines(Input_Features=merged_hin, Output_Feature_Class=hin_points, Point_Placement="DISTANCE", Distance="100 Meters", Include_End_Points="END_POINTS")

    # Process: Spatial Join (4) (Spatial Join) (analysis)
    sidewalks_long2 = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalks_long2"
    arcpy.analysis.SpatialJoin(target_features=projected_gaps_2_, join_features=hin_points, out_feature_class=sidewalks_long2, join_operation="JOIN_ONE_TO_MANY", field_mapping="seg_length \"seg_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,seg_length,-1,-1;sw_side1_length \"sw_side1_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,sw_side1_length,-1,-1;sw_side2_length \"sw_side2_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,sw_side2_length,-1,-1;side1_coverage_pct \"side1_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,side1_coverage_pct,-1,-1;side2_coverage_pct \"side2_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,side2_coverage_pct,-1,-1;sw_id \"sw_id\" true true false 0 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,sw_id,0,254;hin_id \"hin_id\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\hin_points,hin_id,-1,-1", match_option="WITHIN_A_DISTANCE", search_radius="10 Meters")

    # Process: Field Statistics To Table (Field Statistics To Table) (management)
    sidewalks_hin, sidewalks_fhwa_func_class, Output_Table_for_Date_Fields, sidewalks_long_summed = arcpy.management.FieldStatisticsToTable(in_table=sidewalks_long2, in_fields=["hin_id"], out_location=SidewalkConstructionIndex_gdb, out_tables=[["NUMERIC", "sidewalks_hin"]], group_by_field="sw_id", out_statistics=[["COUNT", "hin_point_count"]])

    # Process: Join Field (Join Field) (management)
    projected_gaps_3_ = arcpy.management.JoinField(in_data=projected_gaps_2_, in_field="sw_id", join_table=sidewalks_hin, join_field="sw_id", fields=["hin_point_count"])[0]

    # Process: Copy Features (3) (Copy Features) (management)
    Output_Feature_Class_2_ = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures"
    with arcpy.EnvManager(outputCoordinateSystem="PROJCS[\"NAD_1983_UTM_Zone_18N\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"False_Easting\",500000.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-75.0],PARAMETER[\"Scale_Factor\",0.9996],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]]"):
        arcpy.management.CopyFeatures(in_features=gis_transportation_njdot_functionalclass_2_, out_feature_class=Output_Feature_Class_2_)

    # Process: Calculate Field (4) (Calculate Field) (management)
    NJDOT_FunctionalClass_CopyFeatures = arcpy.management.CalculateField(in_table=Output_Feature_Class_2_, field="fhwa_func_cls", expression="Reclass(!descr!)", code_block="""# Reclassify values to another value
def Reclass(arg):
    if arg==\"Principal Arterial – Other Freeways and Expressways\":
        return 2
    elif arg==\"Interstate\":
        return 1
    elif arg==\"Principal Arterial – Other\":
        return 3
    elif arg==\"Minor Arterial\":
        return 4
    elif arg==\"Major Collector\":
        return 5
    elif arg==\"Minor Collector\":
        return 6
    elif arg==\"Local\":
        return 7
    return 99""")[0]

    # Process: Copy Features (4) (Copy Features) (management)
    projected_padot_rmsadmin = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin"
    with arcpy.EnvManager(outputCoordinateSystem="PROJCS[\"NAD_1983_UTM_Zone_18N\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"False_Easting\",500000.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-75.0],PARAMETER[\"Scale_Factor\",0.9996],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]]"):
        arcpy.management.CopyFeatures(in_features=gis_transportation_padot_rmsadmin, out_feature_class=projected_padot_rmsadmin)

    # Process: Merge (2) (Merge) (management)
    functional_merge = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\functional_merge"
    with arcpy.EnvManager(outputCoordinateSystem="PROJCS[\"NAD_1983_UTM_Zone_18N\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"False_Easting\",500000.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-75.0],PARAMETER[\"Scale_Factor\",0.9996],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]]"):
        arcpy.management.Merge(inputs=[NJDOT_FunctionalClass_CopyFeatures, projected_padot_rmsadmin], output=functional_merge, field_mappings="id \"id\" true true false 4 Long 0 10,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures,id,-1,-1;sri \"sri\" true true false 20 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures,sri,0,19;mp_start \"mp_start\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures,mp_start,-1,-1;mp_end \"mp_end\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures,mp_end,-1,-1;descr \"descr\" true true false 100 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures,descr,0,99;st_length(shape) \"st_length(shape)\" false true true 0 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures,st_length(shape),-1,-1,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,st_length(shape),-1,-1;fhwa_func_cls \"fhwa_func_cls\" true true false 0 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\NJDOT_FunctionalClass_CopyFeatures,fhwa_func_cls,0,254,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,fhwa_func_cls,0,1073741821;objectid_1 \"objectid_1\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,objectid_1,-1,-1;st_rt_no \"st_rt_no\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,st_rt_no,0,1073741821;cty_code \"cty_code\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,cty_code,0,1073741821;district_no \"district_no\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,district_no,0,1073741821;juris \"juris\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,juris,0,1073741821;seg_bgn \"seg_bgn\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,seg_bgn,0,1073741821;offset_bgn \"offset_bgn\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,offset_bgn,-1,-1;seg_end \"seg_end\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,seg_end,0,1073741821;offset_end \"offset_end\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,offset_end,-1,-1;seg_lngth_feet \"seg_lngth_feet\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,seg_lngth_feet,-1,-1;seg_pt_bgn \"seg_pt_bgn\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,seg_pt_bgn,0,1073741821;seg_pt_end \"seg_pt_end\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,seg_pt_end,0,1073741821;seq_no \"seq_no\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,seq_no,-1,-1;maint_func_cls \"maint_func_cls\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,maint_func_cls,0,1073741821;post_bond_ind \"post_bond_ind\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,post_bond_ind,0,1073741821;speed_limit \"speed_limit\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,speed_limit,-1,-1;fed_aid_sys \"fed_aid_sys\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,fed_aid_sys,0,1073741821;fed_aid_urban_area \"fed_aid_urban_area\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,fed_aid_urban_area,0,1073741821;func_cls \"func_cls\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,func_cls,0,1073741821;fed_id \"fed_id\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,fed_id,0,1073741821;fed_aid_sys_status \"fed_aid_sys_status\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,fed_aid_sys_status,0,1073741821;mslink \"mslink\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,mslink,-1,-1;mapid \"mapid\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,mapid,0,1073741821;nlf_id \"nlf_id\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,nlf_id,-1,-1;side_ind \"side_ind\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,side_ind,0,1073741821;nlf_cntl_bgn \"nlf_cntl_bgn\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,nlf_cntl_bgn,-1,-1;nlf_cntl_end \"nlf_cntl_end\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,nlf_cntl_end,-1,-1;cum_offset_bgn_t1 \"cum_offset_bgn_t1\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,cum_offset_bgn_t1,-1,-1;cum_offset_end_t1 \"cum_offset_end_t1\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,cum_offset_end_t1,-1,-1;record_update \"record_update\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,record_update,0,1073741821;fips_area_code \"fips_area_code\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,fips_area_code,0,1073741821;geometrylen \"geometrylen\" true true false 8 Double 8 38,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,geometrylen,-1,-1;geometry \"geometry\" true true false 1073741822 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_padot_rmsadmin,geometry,0,1073741821")

    # Process: Pairwise Clip (Pairwise Clip) (analysis)
    region_roads = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\region_roads"
    arcpy.analysis.PairwiseClip(in_features=functional_merge, clip_features=gis_boundaries_dvrpc_mcd_phicpa, out_feature_class=region_roads)

    # Process: Generate Points Along Lines (Generate Points Along Lines) (management)
    region_roads_points = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\region_roads_points"
    arcpy.management.GeneratePointsAlongLines(Input_Features=region_roads, Output_Feature_Class=region_roads_points, Point_Placement="DISTANCE", Distance="10 Meters", Include_End_Points="NO_END_POINTS")

    # Process: Spatial Join (3) (Spatial Join) (analysis)
    sidewalks_long = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalks_long"
    arcpy.analysis.SpatialJoin(target_features=projected_gaps_2_, join_features=region_roads_points, out_feature_class=sidewalks_long, join_operation="JOIN_ONE_TO_MANY", field_mapping="shape_Length \"shape_Length\" false true true 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,Shape_Length,-1,-1;sw_id \"sw_id\" true true false 512 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,sw_id,0,511;seg_length \"seg_length\" true true false 255 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,seg_length,-1,-1;Shape_Length \"Shape_Length\" true true false 255 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,Shape_Length,-1,-1;side1_coverage_pct \"side1_coverage_pct\" true true false 255 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,side1_coverage_pct,-1,-1;side2_coverage_pct \"side2_coverage_pct\" true true false 255 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,side2_coverage_pct,-1,-1;fhwa_func_cls \"fhwa_func_cls\" true true false 255 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\region_roads_points,fhwa_func_cls,0,254;juris_First \"juris_First\" true true false 255 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\region_roads_points,juris,0,254", match_option="WITHIN_A_DISTANCE", search_radius="10 Meters")

    # Process: Field Statistics To Table (2) (Field Statistics To Table) (management)
    sidewalks_hin_2_, sidewalks_fhwa_func_class_2_, Output_Table_for_Date_Fields_2_, sidewalks_long_summed_2_ = arcpy.management.FieldStatisticsToTable(in_table=sidewalks_long, in_fields=["fhwa_func_cls"], out_location=SidewalkConstructionIndex_gdb, out_tables=[["TEXT", "sidewalks_fhwa_func_class"]], group_by_field="sw_id", out_statistics=[["MODE", "fhwa_func_class_mode"]])

    # Process: Join Field (2) (Join Field) (management)
    projected_gaps_4_ = arcpy.management.JoinField(in_data=projected_gaps_3_, in_field="sw_id", join_table=sidewalks_fhwa_func_class_2_, join_field="sw_id")[0]

    # Process: Field Statistics To Table (3) (Field Statistics To Table) (management)
    sidewalks_hin_3_, sidewalks_juris, Output_Table_for_Date_Fields_3_, sidewalks_long_summed_3_ = arcpy.management.FieldStatisticsToTable(in_table=sidewalks_long, in_fields=["juris_First"], out_location=SidewalkConstructionIndex_gdb, out_tables=[["TEXT", "sidewalks_juris"]], group_by_field="sw_id", out_statistics=[["MODE", "juris_mode"]])

    # Process: Join Field (3) (Join Field) (management)
    projected_gaps_6_ = arcpy.management.JoinField(in_data=projected_gaps_4_, in_field="sw_id", join_table=sidewalks_juris, join_field="sw_id", fields=["juris_mode"])[0]

    # Process: Spatial Join (Spatial Join) (analysis)
    sidewalkgaps_eta = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta"
    arcpy.analysis.SpatialJoin(target_features=projected_gaps_6_, join_features=chstp_priority_score, out_feature_class=sidewalkgaps_eta, field_mapping="seg_length \"seg_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,seg_length,-1,-1;sw_side1_length \"sw_side1_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,sw_side1_length,-1,-1;sw_side2_length \"sw_side2_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,sw_side2_length,-1,-1;side1_coverage_pct \"side1_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,side1_coverage_pct,-1,-1;side2_coverage_pct \"side2_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,side2_coverage_pct,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,Shape_Length,-1,-1;sw_id \"sw_id\" true true false 512 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,sw_id,0,511;hin_point_count \"Count\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,hin_point_count,-1,-1;fhwa_func_class_mode \"Mode\" true true false 19 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,fhwa_func_class_mode,0,18;juris_mode \"Mode\" true true false 19 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\projected_gaps,juris_mode,0,18;geoid \"geoid\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\_OngoingProjects\\ETA\\FY2024\\project_output\\output.gdb\\chstp_priority_score,geoid,0,1999999999;eta_score_Max \"eta_score_Max\" true true false 255 Double 0 0,Max,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\_OngoingProjects\\ETA\\FY2024\\project_output\\output.gdb\\chstp_priority_score,eta_score,-1,-1;eta_score_Min \"eta_score_Min\" true true false 255 Double 0 0,Min,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\_OngoingProjects\\ETA\\FY2024\\project_output\\output.gdb\\chstp_priority_score,eta_score,-1,-1", match_option="WITHIN_A_DISTANCE", search_radius="10 Meters")

    # Process: Spatial Join (6) (Spatial Join) (analysis)
    sidewalkgaps_4_ = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps"
    arcpy.analysis.SpatialJoin(target_features=sidewalkgaps_eta, join_features=gis_planning_diz_blockgroup, out_feature_class=sidewalkgaps_4_, field_mapping="seg_length \"seg_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,seg_length,-1,-1;sw_side1_length \"sw_side1_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,sw_side1_length,-1,-1;sw_side2_length \"sw_side2_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,sw_side2_length,-1,-1;side1_coverage_pct \"side1_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,side1_coverage_pct,-1,-1;side2_coverage_pct \"side2_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,side2_coverage_pct,-1,-1;sw_id \"sw_id\" true true false 512 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,sw_id,0,254;hin_point_count \"Count\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,hin_point_count,-1,-1;fhwa_func_class_mode \"Mode\" true true false 19 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,fhwa_func_class_mode,0,18;juris_mode \"Mode\" true true false 19 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,juris_mode,0,18;geoid \"geoid\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,geoid,0,1999999999;eta_score_Max \"eta_score_Max\" true true false 255 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,eta_score_Max,-1,-1;eta_score_Min \"eta_score_Min\" true true false 255 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_eta,eta_score_Min,-1,-1;diz_zone \"diz_zone\" true true false 8 Double 0 0,First,#,V:\\Planning\\planning@gis.sde\\gis.planning.diz_blockgroup,diz_zone,-1,-1", match_option="WITHIN_A_DISTANCE", search_radius="10 Meters")

    # Process: Near (Near) (analysis)
    sidewalkgaps_6_ = arcpy.analysis.Near(in_features=sidewalkgaps_4_, near_features=[gis_structure_schools_private_k12, gis_structure_schools_public_k12], field_names=[["NEAR_DIST", "School_Dist"], ["NEAR_FID", "School_ID"]], distance_unit="Miles")[0]

    # Process: Select (Select) (analysis)
    septabusstops = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\septabusstops"
    with arcpy.EnvManager(outputCoordinateSystem="PROJCS[\"NAD_1983_UTM_Zone_18N\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"False_Easting\",500000.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-75.0],PARAMETER[\"Scale_Factor\",0.9996],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]]"):
        arcpy.analysis.Select(in_features=gis_transportation_septa_transitstops, out_feature_class=septabusstops)

    # Process: Select (2) (Select) (analysis)
    njtbusstops = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\njtbusstops"
    with arcpy.EnvManager(outputCoordinateSystem="PROJCS[\"NAD_1983_UTM_Zone_18N\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"False_Easting\",500000.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-75.0],PARAMETER[\"Scale_Factor\",0.9996],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]]"):
        arcpy.analysis.Select(in_features=gis_transportation_njtransit_transitstops, out_feature_class=njtbusstops, where_clause="stop_type IN ('FS', 'MB', 'NS', 'TM')")

    # Process: Near (2) (Near) (analysis)
    sidewalkgaps_11_ = arcpy.analysis.Near(in_features=sidewalkgaps_6_, near_features=[septabusstops, njtbusstops], method="PLANAR", field_names=[["NEAR_DIST", "Bus_Dist"], ["NEAR_FID", "Bus_ID"]], distance_unit="Miles")[0]

    # Process: Near (3) (Near) (analysis)
    sidewalkgaps_9_ = arcpy.analysis.Near(in_features=sidewalkgaps_11_, near_features=[gis_transportation_PassengerRailStations], field_names=[["NEAR_DIST", "Rail_Dist"], ["NEAR_FID", "Rail_ID"]], distance_unit="Miles")[0]

    # Process: Select (3) (Select) (analysis)
    OpenSpace_NonFarm = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\OpenSpace_NonFarm"
    with arcpy.EnvManager(outputCoordinateSystem="PROJCS[\"NAD_1983_UTM_Zone_18N\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"False_Easting\",500000.0],PARAMETER[\"False_Northing\",0.0],PARAMETER[\"Central_Meridian\",-75.0],PARAMETER[\"Scale_Factor\",0.9996],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]]"):
        arcpy.analysis.Select(in_features=gis_planning_dvrpc_protectedopenspace, out_feature_class=OpenSpace_NonFarm, where_clause="os_type <> 'PRESERVED FARMLAND'")

    # Process: Near (5) (Near) (analysis)
    sidewalkgaps_7_ = arcpy.analysis.Near(in_features=sidewalkgaps_9_, near_features=[OpenSpace_NonFarm, TrailIntersections], field_names=[["NEAR_DIST", "Rec_Dist"], ["NEAR_FC", "Rec_FC"], ["NEAR_FID", "Rec_ID"]], distance_unit="Miles")[0]

    # Process: Select (4) (Select) (analysis)
    existingsidewalks = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\existingsidewalks"
    arcpy.analysis.Select(in_features=gis_transportation_pedestriannetwork_lines, out_feature_class=existingsidewalks, where_clause="raised = 'N/A'")

    # Process: Near (4) (Near) (analysis)
    sidewalkgaps_8_ = arcpy.analysis.Near(in_features=sidewalkgaps_7_, near_features=[existingsidewalks], field_names=[["NEAR_FID", "Sidewalk_FID"], ["NEAR_DIST", "Sidewalk_DIST"]], distance_unit="Meters")[0]

    # Process: Add Fields (multiple) (Add Fields (multiple)) (management)
    sidewalkgaps_13_ = arcpy.management.AddFields(in_table=sidewalkgaps_8_, field_description=[["road_ownership", "TEXT", "Road Ownership", "255", "", ""], ["score_transp", "LONG", "Transportation Need Score", "", "", ""], ["score_hin", "LONG", "High-Injury Score", "", "", ""], ["score_roadclass", "LONG", "Roadway Classification Score", "", "", ""], ["score_diz", "LONG", "Development Intensity Score", "", "", ""], ["score_school", "LONG", "School Proximity Score", "", "", ""], ["score_parks", "LONG", "Recreation Proximity Score", "", "", ""], ["score_rail", "LONG", "Rail Station Proximity Score", "", "", ""], ["score_bus", "LONG", "Bus Stop Proximity Score", "", "", ""], ["score_swprox", "LONG", "Sidewalk Proximity Score", "", "", ""], ["sci_score", "FLOAT", "Sidewalk Construction Index Score", "", "", ""]])[0]

    # Process: Calculate Field (Calculate Field) (management)
    sidewalkgaps_5_ = arcpy.management.CalculateField(in_table=sidewalkgaps_13_, field="score_hin", expression="categorize(!hin_point_count!)", code_block="""def categorize(HIN):
    if HIN is None:
        return 1
    elif HIN>0:
        return 10
    else: 
        return 1""")[0]

    # Process: Calculate Field (3) (Calculate Field) (management)
    sidewalkgaps_15_ = arcpy.management.CalculateField(in_table=sidewalkgaps_5_, field="score_transp", expression="catps(!eta_score_Max!,!eta_score_Min!)", code_block="""def catps(psmax, psmin):
    ps = max(abs(psmax),abs(psmin))
    if ps>25:
        return 10
    elif ps>= 15:
        return 7
    elif ps>= 10:
        return 4
    elif ps<10:
        return 1
    else:
        return 0""")[0]

    # Process: Calculate Field (2) (Calculate Field) (management)
    sidewalkgaps = arcpy.management.CalculateField(in_table=sidewalkgaps_15_, field="score_roadclass", expression="roadscore(!fhwa_func_class_mode!)", code_block="""def roadscore(tag):
    if tag == None or tag == \"[All Unique Values]\":
        return 1
    elif tag == \"3\":
        return 10
    elif tag == \"4\":
        return 7
    elif tag == \"5\" or tag == \"6\":
        return 4
    else:
        return 1""")[0]

    # Process: Calculate Field (9) (Calculate Field) (management)
    sidewalkgaps_12_ = arcpy.management.CalculateField(in_table=sidewalkgaps, field="score_diz", expression="dizscore(!diz_zone!)", code_block="""def dizscore(x):
    if x==0 or x==1: return 1
    elif x>1: 
        return int(x*2-2)
    else: return -1""")[0]

    # Process: Calculate Fields (multiple) (Calculate Fields (multiple)) (management)
    sidewalkgaps_3_ = arcpy.management.CalculateFields(in_table=sidewalkgaps_12_, expression_type="PYTHON3", fields=[["score_school", "distscore(!School_Dist!)", "", ""], ["score_parks", "distscore(!Rec_Dist!)", "", ""], ["score_rail", "distscore(!Rail_Dist!)", "", ""], ["score_bus", "distscore(!Bus_Dist!)", "", ""]], code_block="""def distscore(dist):
    if dist < 0.125:
        return 10
    elif dist < 0.25:
        return 7
    elif dist < 0.5:
        return 4
    else: return 1""")[0]

    # Process: Calculate Field (10) (Calculate Field) (management)
    sidewalkgaps_10_ = arcpy.management.CalculateField(in_table=sidewalkgaps_3_, field="score_swprox", expression="getproxscore(!Sidewalk_Dist!)", code_block="""def getproxscore(x):
    if x < 1:
        return 10
    elif x < 25:
        return 5
    else:
        return 1""")[0]

    # Process: Calculate Field (8) (Calculate Field) (management)
    sidewalkgaps_16_ = arcpy.management.CalculateField(in_table=sidewalkgaps_10_, field="sci_score", expression=".15*!score_transp!+.15*!score_hin!+.1*!score_roadclass!+.1*!score_diz!+.1*!score_school!+.1*!score_parks!+.1*!score_rail!+.1*!score_bus!+.1*!score_swprox!")[0]

    # Process: Calculate Field (6) (Calculate Field) (management)
    sidewalkgaps_2_ = arcpy.management.CalculateField(in_table=sidewalkgaps_16_, field="road_ownership", expression="ownership(!juris_mode!)", code_block="""def ownership(x):
    if x is None:
        return \"Unknown\"
    elif x == \"1\":
        return \"State\" 
    elif x == \"4\":
        return \"Non-State Non-Federal Aid Road\"
    elif x == \"2\":
        return \"Turnpike\"
    elif x == \"3\":
        return \"Agency\"
    elif x == \"5\":
        return \"Non-State Federal Aid Road\"
    elif x == \"6\":
        return \"Toll Bridge\"
    elif x == \"8\":
        return \"Local Road\"
    else:
        return \"Unknown\"""")[0]

    # Process: Spatial Join (5) (Spatial Join) (analysis)
    sidewalkgaps_aopp = "U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp"
    arcpy.analysis.SpatialJoin(target_features=sidewalkgaps_2_, join_features=AOPPorHDC_shp, out_feature_class=sidewalkgaps_aopp, field_mapping="Join_Count \"Join_Count\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Join_Count,-1,-1;TARGET_FID \"TARGET_FID\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,TARGET_FID,-1,-1;seg_length \"seg_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,seg_length,-1,-1;sw_side1_length \"sw_side1_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,sw_side1_length,-1,-1;sw_side2_length \"sw_side2_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,sw_side2_length,-1,-1;side1_coverage_pct \"side1_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,side1_coverage_pct,-1,-1;side2_coverage_pct \"side2_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,side2_coverage_pct,-1,-1;sw_id \"sw_id\" true true false 512 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,sw_id,0,511;hin_point_count \"Count\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,hin_point_count,-1,-1;fhwa_func_class_mode \"Mode\" true true false 19 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,fhwa_func_class_mode,0,18;juris_mode \"Mode\" true true false 19 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,juris_mode,0,18;geoid \"geoid\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,geoid,0,1999999999;eta_score_Max \"eta_score_Max\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,eta_score_Max,-1,-1;eta_score_Min \"eta_score_Min\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,eta_score_Min,-1,-1;diz_zone \"diz_zone\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,diz_zone,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Shape_Length,-1,-1;School_Dist \"School_Dist\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,School_Dist,-1,-1;School_ID \"School_ID\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,School_ID,-1,-1;NEAR_FC \"NEAR_FC\" true true false 255 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,NEAR_FC,0,254;Bus_Dist \"Bus_Dist\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Bus_Dist,-1,-1;Bus_ID \"Bus_ID\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Bus_ID,-1,-1;Rail_Dist \"Rail_Dist\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Rail_Dist,-1,-1;Rail_ID \"Rail_ID\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Rail_ID,-1,-1;Rec_Dist \"Rec_Dist\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Rec_Dist,-1,-1;Rec_FC \"Rec_FC\" true true false 255 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Rec_FC,0,254;Rec_ID \"Rec_ID\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Rec_ID,-1,-1;Sidewalk_FID \"Sidewalk_FID\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Sidewalk_FID,-1,-1;Sidewalk_DIST \"Sidewalk_DIST\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,Sidewalk_DIST,-1,-1;road_ownership \"Road Ownership\" true true false 255 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,road_ownership,0,254;score_transp \"Transportation Need Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_transp,-1,-1;score_hin \"High-Injury Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_hin,-1,-1;score_roadclass \"Roadway Classification Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_roadclass,-1,-1;score_diz \"Development Intensity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_diz,-1,-1;score_school \"School Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_school,-1,-1;score_parks \"Recreation Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_parks,-1,-1;score_rail \"Rail Station Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_rail,-1,-1;score_bus \"Bus Stop Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_bus,-1,-1;score_swprox \"Sidewalk Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,score_swprox,-1,-1;sci_score \"Sidewalk Construction Index Score\" true true false 4 Float 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps,sci_score,-1,-1;objectid \"objectid\" true true false 10 Long 0 10,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,objectid,-1,-1;statefp10 \"statefp10\" true true false 2 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,statefp10,0,1;countyfp10 \"countyfp10\" true true false 3 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,countyfp10,0,2;tractce10 \"tractce10\" true true false 6 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,tractce10,0,5;geoid10 \"geoid10\" true true false 11 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,geoid10,0,10;name10 \"name10\" true true false 7 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,name10,0,6;namelsad10 \"namelsad10\" true true false 20 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,namelsad10,0,19;mtfcc10 \"mtfcc10\" true true false 5 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,mtfcc10,0,4;funcstat10 \"funcstat10\" true true false 1 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,funcstat10,0,0;aland10 \"aland10\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,aland10,-1,-1;awater10 \"awater10\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,awater10,-1,-1;intptlat10 \"intptlat10\" true true false 11 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,intptlat10,0,10;intptlon10 \"intptlon10\" true true false 12 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,intptlon10,0,11;geoid_1 \"geoid\" true true false 18 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,geoid,0,17;dvrpc_reg \"dvrpc_reg\" true true false 3 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,dvrpc_reg,0,2;dvrpc_28co \"dvrpc_28co\" true true false 3 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,dvrpc_28co,0,2;p0010001 \"p0010001\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010001,-1,-1;p0010002 \"p0010002\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010002,-1,-1;p0010003 \"p0010003\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010003,-1,-1;p0010004 \"p0010004\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010004,-1,-1;p0010005 \"p0010005\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010005,-1,-1;p0010006 \"p0010006\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010006,-1,-1;p0010007 \"p0010007\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010007,-1,-1;p0010008 \"p0010008\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010008,-1,-1;p0010009 \"p0010009\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0010009,-1,-1;p0020002 \"p0020002\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0020002,-1,-1;p0020003 \"p0020003\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0020003,-1,-1;p0030001 \"p0030001\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030001,-1,-1;p0030002 \"p0030002\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030002,-1,-1;p0030003 \"p0030003\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030003,-1,-1;p0030004 \"p0030004\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030004,-1,-1;p0030005 \"p0030005\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030005,-1,-1;p0030006 \"p0030006\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030006,-1,-1;p0030007 \"p0030007\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030007,-1,-1;p0030008 \"p0030008\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030008,-1,-1;p0030009 \"p0030009\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0030009,-1,-1;p0040002 \"p0040002\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0040002,-1,-1;p0040003 \"p0040003\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,p0040003,-1,-1;h0010001 \"h0010001\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,h0010001,-1,-1;h0010002 \"h0010002\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,h0010002,-1,-1;h0010003 \"h0010003\" true true false 19 Double 8 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,h0010003,-1,-1;stateco \"stateco\" true true false 10 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,stateco,0,9;st_area_sh \"st_area_sh\" true true false 19 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,st_area_sh,-1,-1;st_perimet \"st_perimet\" true true false 19 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,st_perimet,-1,-1;OID_ \"OID_\" true true false 9 Long 0 9,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,OID_,-1,-1;ID \"ID\" true true false 19 Double 5 18,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,ID,-1,-1;STATE \"STATE\" true true false 254 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,STATE,0,253;COUNTY \"COUNTY\" true true false 254 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,COUNTY,0,253;TRACTNAME \"TRACTNAME\" true true false 254 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,TRACTNAME,0,253;APPCOUNTY \"APPCOUNTY\" true true false 254 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,APPCOUNTY,0,253;APPTRACT \"APPTRACT\" true true false 254 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,APPTRACT,0,253;G_HDCTRACT \"G_HDCTRACT\" true true false 254 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\..\\..\\..\\FY2023\\Transportation\\AreasOfPersistentPoverty\\shapefiles\\AOPPorHDC.shp,G_HDCTRACT,0,253")

    # Process: Calculate Field (7) (Calculate Field) (management)
    sidewalkgaps_aopp_3_ = arcpy.management.CalculateField(in_table=sidewalkgaps_aopp, field="AOPPorHDC", expression="aopp(!APPTRACT!,!G_HDCTRACT!)", code_block="""def aopp(aopp, hdc):
    if aopp == \"Yes\":
        if hdc == \"Yes\":
            return \"Both\"
        else: 
            return \"AoPP\"
    elif hdc == \"Yes\":
        return \"HDC\"
    else:
        return \"Neither\"""")[0]

    # Process: Spatial Join (2) (Spatial Join) (analysis)
    sidewalkconstructionindex = "U:\\FY2025\\SidewalkGap\\project_output\\output.gdb\\sidewalkconstructionindex"
    arcpy.analysis.SpatialJoin(target_features=sidewalkgaps_aopp_3_, join_features=gis_boundaries_MunicipalBoundaries, out_feature_class=sidewalkconstructionindex, field_mapping="objectid \"objectid\" true true false 10 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,OBJECTID,-1,-1;seg_length \"seg_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,seg_length,-1,-1;sw_side1_length \"sw_side1_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,sw_side1_length,-1,-1;sw_side2_length \"sw_side2_length\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,sw_side2_length,-1,-1;side1_coverage_pct \"side1_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,side1_coverage_pct,-1,-1;side2_coverage_pct \"side2_coverage_pct\" true true false 8 Double 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,side2_coverage_pct,-1,-1;sw_id \"sw_id\" true true false 512 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,sw_id,0,254;geoid \"geoid\" true true false 2000000000 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,geoid,0,17;co_name \"co_name\" true true false 35 Text 0 0,First,#,V:\\Boundaries\\boundaries@gis.sde\\gis.boundaries.MunicipalBoundaries,co_name,0,34;mun_name \"mun_name\" true true false 40 Text 0 0,First,#,V:\\Boundaries\\boundaries@gis.sde\\gis.boundaries.MunicipalBoundaries,mun_name,0,39;AOPPorHDC \"AOPPorHDC\" true true false 40 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,AOPPorHDC,0,39;road_ownership \"Road Ownership\" true true false 255 Text 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,road_ownership,0,254;score_transp \"Transportation Need Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_transp,-1,-1;score_hin \"High-Injury Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_hin,-1,-1;score_roadclass \"Roadway Classification Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_roadclass,-1,-1;score_diz \"Development Intensity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_diz,-1,-1;score_school \"School Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_school,-1,-1;score_parks \"Recreation Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_parks,-1,-1;score_rail \"Rail Station Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_rail,-1,-1;score_bus \"Bus Stop Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_bus,-1,-1;score_swprox \"Sidewalk Proximity Score\" true true false 4 Long 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,score_swprox,-1,-1;sci_score \"Sidewalk Construction Index Score\" true true false 4 Float 0 0,First,#,U:\\FY2025\\SidewalkGap\\arcpro\\SidewalkConstructionIndex.gdb\\sidewalkgaps_aopp,sci_score,-1,-1")

    # Process: Make Feature Layer (Make Feature Layer) (management)
    sidewalkconstructionindex_layer = "sidewalkconstructionindex_layer"
    arcpy.management.MakeFeatureLayer(in_features=sidewalkconstructionindex, out_layer=sidewalkconstructionindex_layer, where_clause="side1_coverage_pct < 80 And side2_coverage_pct < 80 And Shape_Length > 20")

    # Process: Apply Symbology From Layer (Apply Symbology From Layer) (management)
    sidewalkgaps_Layer = arcpy.management.ApplySymbologyFromLayer(in_layer=sidewalkconstructionindex_layer, in_symbology_layer=sidewalkgaps_symbology, symbology_fields=[["VALUE_FIELD", "sci_score", "sci_score"]])[0]

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace="U:\\FY2025\\Planning\\PottstownStationConcept\\arcpro\\PottstownTransportation\\PottstownTransportation.gdb", workspace="U:\\FY2025\\Planning\\PottstownStationConcept\\arcpro\\PottstownTransportation\\PottstownTransportation.gdb"):
        BaseSidewalkConstructionIndex()
